<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <UsesMoq>true</UsesMoq>
  </PropertyGroup>

  <ItemGroup>
    <!-- Auto-generate mocks flagged by these two analyers. -->
    <AutoCodeFix Include="MOQ001;MOQ002" />

    <!-- CodeFix analyzers should only be added to DTBs since they depend on 
         editor features that are not available from csc/vbc -->
    <CodeFix Include="$(MSBuildThisFileDirectory)netstandard.dll" />
    <CodeFix Include="$(MSBuildThisFileDirectory)Moq.CodeFix.dll" />
  </ItemGroup>

  <ItemGroup>
    <!-- Include generated mocks from intermediate output -->
    <Compile Include="$(IntermediateOutputPath)Mocks/*$(DefaultLanguageSourceExtension)">
      <!-- Even with this metadata, the obj/Debug/... folder structure is shown :( -->
      <Visible>false</Visible>
      <!-- We basically need to link to outside the project cone -->
      <Link>../Mocks/%(RecursiveDir)%(Filename)%(Extension)</Link>
      <IsIntermediateCodeGen>true</IsIntermediateCodeGen>
    </Compile>
    <!-- Ensure nuget-linked source content files are not shown in the project -->
    <Compile Update="$(NuGetPackageRoot)moq/*/contentFiles/**/*$(DefaultLanguageSourceExtension)">
      <!-- Since these are not under the project directory, without a link, they do dissapear -->
      <Visible>false</Visible>
      <Link />
    </Compile>
    <IntermediateCodeGenPath Include="$(IntermediateOutputPath)Mocks/" />
  </ItemGroup>

</Project>